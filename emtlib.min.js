function emtDebugLib(){this.ver="1.0",this.specialServer="efimd","undefined"!=typeof lpMTagConfig&&lpMTagConfig.lpServer==this.specialServer?this.baseURL="http://"+this.specialServer+"/emtdebug/":this.baseURL="http://lpdevnew/training/emtdebuglib/",this.cssUrl=this.baseURL+"emtDebugLib.css",this.debugCookieName="LP_MTAG_DEBUG_MODE",this.chkSiteSrv="",this.showTimeinLog=!1,this.showLogFilter=!1,this.activeFilter=[],this.msgShown=!1,this.timerPeriod="undefined"==typeof lpMTagConfig||"undefined"==typeof lpMTagConfig.emtDebugTimerPeriod?1:lpMTagConfig.emtDebugTimerPeriod,this.zindex="undefined"==typeof lpMTagConfig||"undefined"==typeof lpMTagConfig.emtDebugZindex?1e3:lpMTagConfig.emtDebugZindex,this.logMaxLines="undefined"==typeof lpMTagConfig||"undefined"==typeof lpMTagConfig.mtagDebugMaxLine?500:lpMTagConfig.mtagDebugMaxLine,"undefined"!=typeof lpMTagConfig&&"undefined"!=typeof lpMTagConfig.emtDebugPosX?this.posX=lpMTagConfig.emtDebugPosX:this.posX=10,this.posY="undefined"==typeof lpMTagConfig||"undefined"==typeof lpMTagConfig.emtDebugPosY?10:lpMTagConfig.emtDebugPosY,this.logWindowDimensionLimited=!1,this.maxLogWindowMaxHeight=300,this.maxLogWindowMaxWidth=500,this.timestart=new Date,this.debugCookieName="LP_MTAG_DEBUG_MODE",this.debugCookieValue="cK1FoDtP",this.browser="IE",this.noValueStr="&nbsp;-&nbsp;",this.log=[],this.logErr=[],this.logWarn=[],this.eventLog={dynButton:{},invite:{}},this.msgSources={"Not specified":{source:"Not specified"}},this.ude={},this.logShown=!1,this.toolsShown=!1,this.counters={logLine:0,logErr:0,logWarn:0,logOK:0,connPOST:0,connGET:0},this._LOG_PLAY="play",this._LOG_STOP="stop",this._LOG_PAUSE="pause",this._LOG_TRASH="erase",this.logStatus=this._LOG_PLAY,this.logLineCnt=0,this.garbColStrCnt=0,this.progressSymbols=["&nbsp;-&nbsp;","&nbsp;\\&nbsp;","&nbsp;|&nbsp;","&nbsp;/&nbsp;"],this.progressIdx=0,this.evalToolCnt=0,this.leChatProps={numberOfButtons:0,numberOfStickyButtons:0,numberOfInvitations:0,numberOfButtonsInPage:0,numberOfStickyButtonsInPage:0,numberOfInvitationsInPage:0,ver:"",inPagePluginsArr:null,totalPluginsArr:null,engagementType:{button:"button",sticky_button:"sticky_button",invitation:"invitation"},getNumberOfElements:function(t,e){var i=0;if(!lpMTagDebug.leChatRef)return 0;var o=e?lpMTagDebug.leChatRef.inPagePluginsArr:lpMTagDebug.leChatRef.jsonsArr;if("undefined"!=typeof o)for(var n in o)o[n].type===t&&i++;return i}},this.generateHTML=function(){return this.logCtrlPanelHTML="<a id='emtDebugLibLogPlay' href='javascript:;'><img id='emtDebugLibLogPlayImg' src='"+this.baseURL+"images/pause.png' border='0'></img></a>                                  <a id='emtDebugLibLogStop' href='javascript:;'><img id='emtDebugLibLogStopImg' src='"+this.baseURL+"images/stop.png' border='0'></img></a>                                  <a id='emtDebugLibLogErase' href='javascript:;'><img id='emtDebugLibLogEraseImg' src='"+this.baseURL+"images/trashcan.png' border='0'></img></a>                              ",this.emtHtml="<table id='emtDebugLibMainTable' cellspacing='0' cellpadding='0' border='0'>                            <tbody>                                <tr>                                    <td>                                        <table id='emtDebugLibMainTitleTable' width='100%' height='26px' cellspacing='0' cellpadding='0' border='0'>                                            <tbody>                                                <tr>                                                    <td id='emtDebugTopLeft'></td>                                                    <td id='emtDebugLogo'></td>                                                    <td id='emtDebugLibMainTitle'>&nbsp;LE Monitor ver: "+this.ver+"</td>                                                    <td id='emtDebugLibMinimize'>                                                        <a href='javascript:;' alt='Show Config' title='Show Config'>                                                            <img id='emtDebugLibImgConfig' border='0' src='"+this.baseURL+"images/config.gif'></img>                                                        </a>                                                       <a href='javascript:;' alt='Admin Area' title='Admin Area'>                                                            <img id='emtDebugLibImgAdmin' border='0' src='"+this.baseURL+"images/admin.gif'></img>                                                        </a>                                                        <a href='javascript:;' alt='Visitor Logoff' title='Visitor Logoff'>                                                            <img id='emtDebugLibImgLogoff' border='0' src='"+this.baseURL+"images/logout.gif'></img>                                                        </a>                                                        <a href='javascript:;' alt='Minimize / Maximize' title='Minimize / Maximize'>                                                            <img id='emtDebugLibImgMinimize' border='0' src='"+this.baseURL+"images/minimize_box.png'></img>                                                        </a>                                                    </td>                                                    <td id='emtDebugLibTopRight'></td>                                                </tr>                                            </tbody>                                        </table>                                    </td>                                </tr>                                <tr id='emtDebugLibMonitorWindow'>                                    <td>                                        <table id='emtDebugMainMonitorTable' width='100%' cellspacing='0' cellpadding='0' border='0'>                                            <tbody>                                                <tr class='emtDebugLibmainTableTopRow'>                                                    <td colspan='2'>Site ID</td>                                                    <td colspan='2' class='emtDebugLibmainTableMiddleRow' id='emtDebugLibEMTsiteSrv'>"+this.noValueStr+"</td>                                                    <td colspan='3'>Content</td>                                                    <td colspan='2'>#Conn</td>                                                    <td colspan='3'>STATUS</td>                                                    <td colspan='3'>LECHAT <span id='leChatVer'></span></td>                                                    <td rowspan='2'>                                                        <a id='emtDebugLibToggleLog' href='javascript:;'>                                                            <img id='mainTableImgShowLog' src='"+this.baseURL+"images/showlog.png' border='0' height='35'></img>                                                        </a>                                                    </td>                                                </tr>                                                <tr class='emtDebugLibmainTableMiddleRow'>                                                    <td class='emtDebugLibmainTableTopRow'>EMT</td>                                                    <td class='emtDebugLibmainTableTopRow'>SRV</td>                                                    <td class='emtDebugLibmainTableTopRow'>LPTAG</td>                                                    <td class='emtDebugLibmainTableTopRow'>TAGV</td>                                                    <td>#DB</td>                                                    <td>#SB</td>                                                    <td>#INV</td>                                                    <td>POST</td>                                                    <td>GET</td>                                                    <td>ERR</td>                                                    <td>WARN</td>                                                    <td>OK</td>                                                    <td>#EB</td>                                                    <td>#SB</td>                                                    <td>#INV</td>                                                </tr>                                                <tr class='emtDebugLibmainTableBottomRow'>                                                    <td id='emtDebugLibEMTver'>"+this.noValueStr+"</td>                                                    <td id='emtDebugLibSRVver'>"+this.noValueStr+"</td>                                                    <td id='emtDebugLibLPTAGver'>"+this.noValueStr+"</td>                                                    <td id='emtDebugLibTAGver'>"+this.noValueStr+"</td>                                                    <td id='emtDebugLibDBcnt'>"+this.noValueStr+"</td>                                                    <td id='emtDebugLibSBcnt'>"+this.noValueStr+"</td>                                                    <td id='emtDebugLibINVcnt'>"+this.noValueStr+"</td>                                                    <td id='emtDebugLibPOSTcnt'>"+this.noValueStr+"</td>                                                    <td id='emtDebugLibGETcnt'>"+this.noValueStr+"</td>                                                    <td id='emtDebugLibERRcnt'>"+this.noValueStr+"</td>                                                    <td id='emtDebugLibWARNcnt'>"+this.noValueStr+"</td>                                                    <td class='emtDebugOK' id='emtDebugLibOKcnt'>"+this.noValueStr+"</td>                                                    <td id='emtDebugLibEMcntLPChat'>"+this.noValueStr+"</td>                                                    <td id='emtDebugLibSBcntLPChat'>"+this.noValueStr+"</td>                                                    <td id='emtDebugLibINVcntLPChat'>"+this.noValueStr+"</td>                                                    <td>                                                        <a id='emtDebugLibToggleTools' href='javascript:;'>                                                            <img id='emtDebugLibImgShowTools' src='"+this.baseURL+"images/tools.png' border='0' width='35'></img>                                                        </a>                                                    </td>                                                </tr>                                            </tbody>                                        </table>                                    </td>                                </tr>                                <tr id='emtDebugLibMainLogWindow'>                                    <td>                                        <table id='emtDebugLibMainLogWindowTable' width='100%' cellspacing='0' cellpadding='0' border='0'>                                            <tbody>                                                <tr id='emtDebugLibMessageWindowHeader'>                                                    <td id='emtDebugLibMessageWindowTitle'></td>                                                    <td id='emtDebugLibMessageWindowCtrlPanel'>                                                        </td>                                                    <td id='emtDebugLibMessageWindowClose'>                                                        <a href='javascript:;'>                                                            <img id='emtDebugLibImgCloseLog' border='0' src='"+this.baseURL+"images/close_box.png'></img>                                                        </a>                                                    </td>                                                </tr>                                                <tr id='emtDebugLibFilterRow' style='display:none;'>                                                    <td  colspan='3'>                                                        <div id='emtDebugLibFilterWindow'>FILTER GOES HERE</div>                                                    </td>                                                </tr                                                <tr>                                                    <td  colspan='3'>                                                        <div id='emtDebugLibLogWindow'></div>                                                    </td>                                                </tr                                            </tbody>                                        </table>                                    </td>                                </tr>                                <tr>                                    <td>                                        <table id='emtDebugLibMainStatusTable' height='20px' width='100%' cellspacing='0' cellpadding='0' border='0'>                                            <tbody>                                                <tr>                                                    <td id='emtDebugLibStatusLeft'></td>                                                    <td id='emtDebugLibStatusCenter'>Status</td>                                                    <td class='emtDebugLibStatusDivider'></td>                                                    <td id='emtDebugLibStatusImageTD'><img id='emtDebugLibStatusImage' src='"+this.baseURL+"images/status_ok.png' border='0'></img></td>                                                    <td class='emtDebugLibStatusDivider'></td>                                                    <td id='emtDebugLibMsgStatusLogPlayerStatus'>Log Active</td>                                                    <td class='emtDebugLibStatusDivider'></td>                                                    <td id='emtDebugLibStatusProgress'></td>                                                    <td class='emtDebugLibStatusDivider'></td>                                                    <td id='emtDebugLibStatusTimeOnPage'></td>                                                    <td id='emtDebugLibStatusResize' class='emtDebugLibStatusResize'></td>                                                </tr>                                            </tbody>                                        </table>                                    </td>                                </tr>                            </tbody>                        </table>                        <div id='emtDebugLibToolsDiv'>                                    <table id='emtDebugLibToolsTable'>                                         <tr onmouseover=\"this.style.background = '#0A246A'\" onmouseout=\"this.style.background='#D4D0C8'\">                                            <td id='emtDebugLibEMTinfo' onmouseover=\"this.style.color = 'white'\" onmouseout=\"this.style.color='black'\">                                                Config Info                                            </td>                                        </tr>                                        <tr onmouseover=\"this.style.background = '#0A246A'\" onmouseout=\"this.style.background='#D4D0C8'\">                                            <td id='emtDebugLibPageinfo' onmouseover=\"this.style.color = 'white'\" onmouseout=\"this.style.color='black'\">                                                Page Info                                            </td>                                        </tr>                                        <tr onmouseover=\"this.style.background = '#0A246A'\" onmouseout=\"this.style.background='#D4D0C8'\">                                            <td id='emtDebugLibShowUDEs' onmouseover=\"this.style.color = 'white'\" onmouseout=\"this.style.color='black'\">                                                Show UDEs                                            </td>                                        </tr>                                        <tr onmouseover=\"this.style.background = '#0A246A'\" onmouseout=\"this.style.background='#D4D0C8'\">                                            <td id='emtDebugLibAdminArea' onmouseover=\"this.style.color = 'white'\" onmouseout=\"this.style.color='black'\">                                                Admin Area                                            </td>                                        </tr>                                        <tr onmouseover=\"this.style.background = '#0A246A'\" onmouseout=\"this.style.background='#D4D0C8'\">                                            <td id='emtDebugLibLogOut' onmouseover=\"this.style.color = 'white'\" onmouseout=\"this.style.color='black'\">                                                Log Out                                            </td>                                        </tr>                                        <tr onmouseover=\"this.style.background = '#0A246A'\" onmouseout=\"this.style.background='#D4D0C8'\">                                            <td id='emtDebugLibMarkVisitor' onmouseover=\"this.style.color = 'white'\" onmouseout=\"this.style.color='black'\">                                                Mark Visitor                                            </td>                                        </tr>                                        <tr onmouseover=\"this.style.background = '#0A246A'\" onmouseout=\"this.style.background='#D4D0C8'\">                                            <td id='emtDebugLibSwitchSnipMode' onmouseover=\"this.style.color = 'white'\" onmouseout=\"this.style.color='black'\">                                                Clear Snip                                            </td>                                        </tr>                                        <tr onmouseover=\"this.style.background = '#0A246A'\" onmouseout=\"this.style.background='#D4D0C8'\">                                            <td id='emtDebugLibStopStartEMT' onmouseover=\"this.style.color = 'white'\" onmouseout=\"this.style.color='black'\">                                                Stop EMT                                            </td>                                        </tr>                                        <tr onmouseover=\"this.style.background = '#0A246A'\" onmouseout=\"this.style.background='#D4D0C8'\">                                            <td id='emtDebugLibEval' onmouseover=\"this.style.color = 'white'\" onmouseout=\"this.style.color='black'\">                                                Eval                                            </td>                                        </tr>                                        <tr onmouseover=\"this.style.background = '#0A246A'\" onmouseout=\"this.style.background='#D4D0C8'\">                                            <td id='emtDebugLibAbout' onmouseover=\"this.style.color = 'white'\" onmouseout=\"this.style.color='black'\">                                                About                                            </td>                                        </tr>                                    </table>                                </div>",this.emtHtml},this.getMaxZindex=function(){for(var t=document.getElementsByTagName?document.getElementsByTagName("*"):document.all,e=0,i=0;i<t.length;i++){var o=t[i],n=null;o.currentStyle?n=o.currentStyle:document.defaultView&&document.defaultView.getComputedStyle&&(n=document.defaultView.getComputedStyle(o,""));var s;s=n?Number(n.zIndex):Number(o.style.zIndex),isNaN(s)||(e=Math.max(e,s))}return e},this.addCss=function(){if(document.createStyleSheet)document.createStyleSheet(this.cssUrl);else{var t="@import url('"+this.cssUrl+"');",e=document.createElement("link");e.rel="stylesheet",e.href="data:text/css,"+escape(t),document.getElementsByTagName("head")[0].appendChild(e)}},this.createGenericDiv=function(t,e,i,o,n,s,r,l,a,g,h){if(document.getElementsByTagName){var u=document.getElementsByTagName("body");if(u&&null==this.GetObj(t)){var d=document.createElement("div");d.setAttribute("id",t),d.setAttribute("name",t),d.style.zIndex=e,d.style.position="absolute",d.style.visibility=g?"visible":"hidden",d.style.left=i+"px",d.style.top=o+"px",null!=n&&(d.style.height=n+"px"),null!=s&&(d.style.width=s+"px"),d.innerHTML=r,d.style.cssText=d.style.cssText+h+"height:"+n+";",null!=l&&(d.style.cursor=l),null!=a&&(d.onclick=a),null!=document.body.firstChild?document.body.insertBefore(d,document.body.firstChild):u.appendChild(d)}}},this.GetObj=function(t){return document.getElementById?document.getElementById(t):document.all?document.all(t):void 0},this.BrowserSniff=function(){if(document.layers)return"NS";var t=navigator.userAgent.toLowerCase();if(document.all){var e=-1!=t.indexOf("opera"),i=-1!=t.indexOf("konqueror");return e?"OPR":i?"KONQ":"IE"}if(document.getElementById){var o=-1!=t.indexOf("firefox");return o?"FF":"MOZ"}return"OTHER"},this.attachEvents=function(){var t=this.GetObj("emtDebugLibMainTitle"),e=this;t.onmousedown=function(t){e.DragStart("emtDebugLibmainDiv",t)},t=this.GetObj("emtDebugLibImgMinimize"),t.onclick=function(){e.minimizeAll()},t=this.GetObj("emtDebugLibToggleLog"),t.onclick=function(){e.toggleLog()},t=this.GetObj("emtDebugLibToggleTools"),t.onclick=function(){e.toggleTools()},t=this.GetObj("emtDebugLibImgCloseLog"),t.onclick=function(){e.minimizeMsgDiv()},t=this.GetObj("emtDebugLibEMTinfo"),t.onclick=function(){e.showEMTinfo()},t=this.GetObj("emtDebugLibPageinfo"),t.onclick=function(){e.pageInfo()},t=this.GetObj("emtDebugLibLogOut"),t.onclick=function(){e.logOut()},t=this.GetObj("emtDebugLibMarkVisitor"),t.onclick=function(){e.markVisitor()},t=this.GetObj("emtDebugLibStopStartEMT"),t.onclick=function(){e.stopStartEMT()},t=this.GetObj("emtDebugLibAbout"),t.onclick=function(){e.about()},t=this.GetObj("emtDebugLibSwitchSnipMode"),t.onclick=function(){e.clearCompactSnippetMode()},t=this.GetObj("emtDebugLibAdminArea"),t.onclick=function(){e.adminAreaLogin()},t=this.GetObj("emtDebugLibEval"),t.onclick=function(){e.evalTool("display","",!0)},t=this.GetObj("emtDebugLibShowUDEs"),t.onclick=function(){e.showUdes()},this.msgShown?(t=this.GetObj("emtDebugLibStatusResize"),t.className="emtDebugLibStatusResize",t.onmousedown=function(t){e.resizeStart("emtDebugLibLogWindow",t)}):(t=this.GetObj("emtDebugLibStatusResize"),t.className="emtDebugLibStatusNOResize"),t=this.GetObj("emtDebugLibImgConfig"),t.onclick=function(){e.maximizeAll(),e.showEMTinfo()},t=this.GetObj("emtDebugLibImgAdmin"),t.onclick=function(){e.adminAreaLogin(!0)},t=this.GetObj("emtDebugLibImgLogoff"),t.onclick=function(){e.logOut(!0)}},this.engagementLeChatInfo=function(t,e){var i=e?this.leChatRef.inPagePluginsArr:this.leChatRef.jsonsArr,o="";this.toolsShown&&this.toggleTools(),this.logShown&&this.toggleLog(),this.leChatRef||"undefined"==typeof i||(o="NO engagements defined"),o="<table>";for(var n in i)i[n].type===t&&(o+="<tr><td>"+this.objectToString(i[n],void 0,!0,"emtDebugLibGeneralInfoNoBorder",!0)+"</tr>",o+="<tr><td>----------------------------------------------------------</td></tr>");return o+="</table>",this.showMsgWindow(!1,"Engagement Info",o,{width:400,height:this.maxLogWindowMaxHeight}),!1},this.statButtonInfo=function(){this.toolsShown&&this.toggleTools(),this.logShown&&this.toggleLog();var t=this,e="";"undefined"==typeof lpMTagStatic&&(e="NO buttons defined"),e="<table>";for(var i in lpMTagStatic)"object"==typeof lpMTagStatic[i]&&"undefined"!=typeof lpMTagStatic[i].config&&(e+="<tr><th>Name:</th>                        <td>"+lpMTagStatic[i].config.name+"</td></tr>",e+="<tr><th>Config:</th>                    <td>"+this.objectToString(lpMTagStatic[i].config,void 0,!0,"emtDebugLibGeneralInfoNoBorder")+"</td></tr>",e+="<tr><td>------------------------------------------</td></tr>");return e+="</table>",this.showMsgWindow(!1,"Static Button Info",e,{width:400,height:t.maxLogWindowMaxHeight}),!1},this.dynButtonInfo=function(){this.toolsShown&&this.toggleTools(),this.logShown&&this.toggleLog();var that=this;this.overrides=null;var html="";if("undefined"==typeof lpMTagConfig||"undefined"==typeof lpMTagConfig.dynButton||0==lpMTagConfig.dynButton.length)html="NO buttons defined";else for(var i=0;i<lpMTagConfig.dynButton.length;i++){var multichannel=!1,vosBut=!1,objRef=lpMTagConfig["dynButton"+i];if(null==objRef&&(objRef=lpMTagConfig["lpMCDynBut"+i],null!=objRef&&(multichannel=!0)),null==objRef&&(objRef=lpMTagConfig["lpVOSDynamicButton"+i],null!=objRef&&(vosBut=!0)),html+="<table class='emtDebugLibGeneralInfo'>",null==objRef)html+="<td>Error getting button reference for: "+lpMTagConfig.dynButton[i].name+"</td>";else{html+="<tr><th>Name:</th>                             <th>"+(multichannel?objRef.butConfig.origButtonName:objRef.origButtonName)+"</th></tr>";var channel="";channel=multichannel?"Multichannel":"undefined"!=typeof objRef.voice?objRef.voice?vosBut?"Voice Single Step":"Voice":"Chat":objRef.channel,html+="<tr><th>Channel:</th>                             <th>"+channel+"</th></tr>";var state=objRef.buttonState;multichannel&&(state="<table class='emtDebugLibGeneralInfoNoBorder'><tr><th>Chat</th><td>"+objRef.buttonState.chat.name+"</td></tr><tr><th>Voice</th><td>"+objRef.buttonState.voice.name+"</td></tr></table>"),html+="<tr><th>State:</th>                             <td>"+state+"</td></tr>";var url="";0==objRef.contentType?url=objRef.imageUrl:1==objRef.contentType?url="Custom Images":2==objRef.contentType&&(url="HTML button"),multichannel||(html+="<tr><th>Image URL:</th>                                 <td>"+url+"</td></tr>");var refresh;if(refresh=multichannel?objRef.butConfig.refresh:objRef.refresh,html+="<tr><th>Refresh:</th>                             <td>"+(-1==refresh?"none":refresh)+"</td></tr>",html+="<tr><th>Config:</th>                             <td>"+this.objectToString(lpMTagConfig.dynButton[i],void 0,!0,"emtDebugLibGeneralInfoNoBorder")+"</td></tr>",html+="<tr><th>Overrides:</th>","undefined"!=typeof lpMTagConfig.dynButton[i].ovr){html+="<td><a id='emtDebugLibDBover"+i+"' href='javascript:;'>show overrides</a></td></tr>",null==this.overrides&&(this.overrides={});var dbOvrRef=eval(lpMTagConfig.dynButton[i].ovr),text="Can not get Object";null!=dbOvrRef&&(text=this.objectToString(dbOvrRef,void 0,!0,"emtDebugLibGeneralInfo")),this.overrides["emtDebugLibDBover"+i]=text}else html+="<td>none</td></tr>";for(var events="",length="undefined"!=typeof this.eventLog.dynButton["but"+i]?this.eventLog.dynButton["but"+i].length:-1,j=0;length>j;j++)events+=this.eventLog.dynButton["but"+i][j]+"<br />";""==events&&(events="None fired"),html+="<tr><th>Events Fired:</th>                             <td>"+events+"</td></tr>",multichannel&&(text=this.objectToString(objRef.butConfig,void 0,!0,"emtDebugLibGeneralInfoNoBorder",!0),null==this.overrides&&(this.overrides={}),this.overrides["emtDebugLibDBMCover"+i]=text,html+="<tr><th>Full Config:</th>                             <td><a id='emtDebugLibDBMCover"+i+"' href='javascript:;'>Show</td></tr>")}html+="</table><br /><br />"}if(this.showMsgWindow(!1,"Dynamic Button Info",html,{width:400,height:that.maxLogWindowMaxHeight}),null!=this.overrides){var elem;for(var name in this.overrides)elem=this.GetObj(name),elem.onclick=function(){that.showMsgWindow(!1,"Dynamic Button Config",that.overrides[this.id],{width:400,height:that.maxLogWindowMaxHeight})}}return!1},this.getInviteID=function(t){var e=parseInt(t.replace(/invite/,""),10);return isNaN(e)&&(e=parseInt(t.replace(/inviteMC/,""),10)),e},this.getInviteOverrideInfo=function(){var t="<b>Invitation Overrides</b><br /><table class='emtDebugLibGeneralInfo'>";for(var e in lpMTagConfig)-1!=e.indexOf("invite")&&"inviteShown"!=e&&isNaN(this.getInviteID(e))&&(t+="<tr><th>"+e+"</th>                                <td>"+lpMTagConfig[e]+"</td></tr>");return t+="</table>"},this.invitationInfo=function(){this.toolsShown&&this.toggleTools(),this.logShown&&this.toggleLog();var t="";if("undefined"==typeof lpMTagConfig)t="NO invitations defined";else{t+="<table class='emtDebugLibGeneralInfo'>";for(var e in lpMTagConfig)if(-1!=e.indexOf("invite")){var i=this.getInviteID(e);if(i>0){var o=lpMTagConfig[e];t+="<tr><th>ID:</th>                                 <th>"+o.inviteID+"</th></tr>",o.inviteName&&(t+="<tr><th>Name:</th>                                 <th>"+o.inviteName+"</th></tr>");var n="";n="undefined"!=typeof o.voice?o.voice?"Voice":"Chat":o.channel,t+="<tr><th>Channel:</th>                                 <th>"+n+"</th></tr>";var s="";0==o.contentType?s=o.imageUrl:2==o.contentType&&(s="HTML invite"),t+="<tr><th>Image URL:</th>                                 <td>"+s+"</td></tr>";for(var r="",l=0;l<this.eventLog.invite["inv"+i].length;l++)r+=this.eventLog.invite["inv"+i][l]+"<br />";""==r&&(r="None fired"),t+="<tr><th>Events Fired:</th>                                 <td>"+r+"</td></tr>"}}t+="</table><br /><br />",t+=this.getInviteOverrideInfo()}return this.showMsgWindow(!1,"Invitation Info",t,{width:400,height:this.maxLogWindowMaxHeight}),!1},this.about=function(){this.toggleTools(),this.logShown&&this.toggleLog();var t="<b>EMT Debug and Tools Library ver: "+this.ver+"</b><br /><br />";return t+="<b>Created By</b>: Efim Dimenstein (2008)<br />",t+="<b>Company</b>: Liveperson<br /><br />",t+="<b>Disclamer</b>: This is work in progress and should be treated as such.<br />",t+=" No guarantees are given on stability of this tool. Use at your own risk.<br /><br />",t+="<b>However suggestions and bug reports are welcome.<b><br /><br />",t+='<b>Send suggestion <a href="mailto:efim@liveperson.com?subject=EMT Debug Library Suggestion">email</a><b><br /><br />',t+='<b>Send bugreport <a href="mailto:efim@liveperson.com?subject=EMT Debug Library Bug Report">email</a><b><br />',this.showMsgWindow(!1,"About",t,{width:400,height:this.maxLogWindowMaxHeight}),!1},this.evalTool=function(action,objStr,displayHTML,title){this.logShown&&this.toggleLog(),this.toolsShown&&this.toggleTools(),this.evalToolCnt=0;var html="<table id='emtDebugLibEvalTable' class='emtDebugLibGeneralInfoNoBorder'>                    <tr><td rowspan=2>                            <textarea id='emtDebugLibEvalInput' rows='3' cols='40'>{VALUE}</textarea>                        </td>                        <td>                            <input type='button' id='emtDebugLibEvalRun' value='Execute' class='emtDebugLibEvalToolBtn'></input><br />                        </td></tr><tr><td>                            <input type='button' id='emtDebugLibEvalContent' value='Show Content' class='emtDebugLibEvalToolBtn'></input><br />                        </td>                    </tr>                   </table>";html+="<hr />","undefined"==typeof title&&(title="Eval Tool&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                    <a id='emtDebugLibEvallpMTagConfig' href=javascript:;>lpMTagConfig</a>&nbsp;&nbsp;&nbsp;&nbsp;                    <a id='emtDebugLibEvallpMTag' href=javascript:;>lpMTag</a>&nbsp;&nbsp;&nbsp;&nbsp;                    <a id='emtDebugLibEvallpConnLib' href=javascript:;>lpConnLib</a>");var value;if("display"==action)this.showMsgWindow(!1,title,html.replace(/{VALUE}/g,""),{width:400,height:this.maxLogWindowMaxHeight});else if("eval"==action){value=this.GetObj("emtDebugLibEvalInput").value;try{eval(value)}catch(e){html+="Error detected in JS:"+e,this.showMsgWindow(!1,title,html.replace(/{VALUE}/g,""),{width:this.maxLogWindowMaxWidth,height:this.maxLogWindowMaxHeight})}}else if("logContent"==action){value="",value="undefined"!=typeof objStr&&""!=objStr?objStr:this.GetObj("emtDebugLibEvalInput").value;var objRef=null;try{objRef=eval(value)}catch(e){return html+="logContent - Error detected in JS:"+e,html=displayHTML?html.replace(/{VALUE}/g,""):"logContent - Error detected in JS:"+e,this.showMsgWindow(!1,title,html,{width:this.maxLogWindowMaxWidth,height:this.maxLogWindowMaxHeight}),!1}var output="";output=null==objRef?"The JS provided did not evaluate to an object or parameter":"object"==typeof objRef?this.objectToString(objRef,void 0,!0,"emtDebugLibGeneralInfo",!0):objRef,html+=output,
this.showMsgWindow(!1,title,displayHTML?html.replace(/{VALUE}/g,""):output,{width:this.maxLogWindowMaxWidth,height:this.maxLogWindowMaxHeight})}else this.showMsgWindow(!1,title,"Invalid action type:"+action,{width:this.maxLogWindowMaxWidth,height:this.maxLogWindowMaxHeight});var that=this,elem=this.GetObj("emtDebugLibEvalRun");return null!=elem&&(elem.onclick=function(){that.evalTool("eval","",!0)}),elem=this.GetObj("emtDebugLibEvalContent"),null!=elem&&(elem.onclick=function(){that.evalTool("logContent","",!0)}),elem=this.GetObj("emtDebugLibEvallpMTagConfig"),null!=elem&&(elem.onclick=function(){that.evalTool("logContent","lpMTagConfig",!0)}),elem=this.GetObj("emtDebugLibEvallpMTag"),null!=elem&&(elem.onclick=function(){that.evalTool("logContent","lpMTag",!0)}),elem=this.GetObj("emtDebugLibEvallpConnLib"),null!=elem&&(elem.onclick=function(){that.evalTool("logContent","lpConnLib",!0)}),!1},this.adminAreaLogin=function(t){t||this.toggleTools();var e=lpMTagConfig.lpServer;"chat.bankofamerica.com"==e&&(e="sec1.liveperson.net");var i="https://"+e+"/hc/web/public/pub/ma/lp/login.jsp?goto=home.jsp&site="+lpMTagConfig.lpNumber+"&useid=1";lpMTagConfig.lpServer==this.specialServer&&(i+="&user=efim&pass=1"),window.open(i)},this.stopStartEMT=function(){return this.toggleTools(),"undefined"!=typeof lpMTag&&(lpMTag.stopMTag?(lpMTag.lpLoopTimer=setTimeout("lpMTag.lpMTagMain()",100),lpMTag.stopMTag=!1):(lpMTag.lpLoopTimer&&clearTimeout(lpMTag.lpLoopTimer),lpMTag.stopMTag=!0)),!1},this.clearCompactSnippetMode=function(){return this.toggleTools(),this.GetCookie(this.debugCookieName)==this.debugCookieValue?this.DeleteCookie(this.debugCookieName,"/"):this.SetCookie(this.debugCookieName,this.debugCookieValue,null,"/"),!1},this.logOut=function(t){t||this.toggleTools();var e=new hcArrayStorage;e.add("cmd","visitorLogout"),e.add("site",lpMTagConfig.lpNumber);var i=lpMTagConfig.lpProtocol+"://"+lpMTagConfig.lpServer+"/hc/"+lpMTagConfig.lpNumber+"/";return"undefined"!=typeof lpMTag.mtagAddToQueue?lpMTag.mtagAddToQueue(i,e,null,!1,0,!0,!1,1):lpConnLib.addToQueue(i,e,null,!1,0,!0,!1,1),!1},this.markVisitor=function(t){t||this.toggleTools();var e=new hcArrayStorage;e.add("cmd","markVisitor"),e.add("site",lpMTagConfig.lpNumber);var i=lpMTagConfig.lpProtocol+"://"+lpMTagConfig.lpServer+"/hc/"+lpMTagConfig.lpNumber+"/";return"undefined"!=typeof lpMTag.mtagAddToQueue?lpMTag.mtagAddToQueue(i,e,null,!1,0,!0,!1,1):lpConnLib.addToQueue(i,e,null,!1,0,!0,!1,1),!1},this.pageInfo=function(){this.toggleTools(),this.logShown&&this.toggleLog();var t="<table class='emtDebugLibGeneralInfo'>";t+="<tr>",t+="<th>Title</th>",t+="<td>"+document.title+"</td>",t+="</tr>",t+="<tr>",t+="<th>URL</th>",t+="<td>"+document.location+"</td>",t+="</tr>",t+="<tr>",t+="<th>Referrer</th>",t+="<td>"+document.referrer+"</td>",t+="</tr>",t+="<tr>";var e=null;return e="function"==typeof lpMTagConfig.GetPageCookies?lpMTagConfig.GetPageCookies():document.cookie,t+="<th>Cookie Length</th>",t+="<td>"+("undefined"==typeof e||null==e?0:e.length)+"</td>",t+="</tr>",t+="<tr>",t+="<th>Cookies</th>",t+="<td>"+("undefined"==typeof e||null==e?"":e)+"</td>",t+="</tr>",t+="</table>",this.showMsgWindow(!1,"Page Info",t,{width:400,height:this.maxLogWindowMaxHeight}),!1},this.showEMTinfo=function(){return this.evalTool("logContent","lpMTagConfig",!1,"EMT Configuration"),!1},this.toggleViewMode=function(t){var e=lpMTagDebug.GetObj("emtDebugLibObjectInfo-"+t);return null!=e&&("none"==e.style.display||""==e.style.display?e.style.display="block":e.style.display="none"),!1},this.objectToString=function(t,e,i,o,n){"undefined"==typeof e&&(e=","),"undefined"==typeof i&&(i=!1),"undefined"==typeof n&&(n=!1);var s,r="";s=i?"<table class='"+o+"'>":"{";var l=!0;for(var a in t){l?l=!1:i||(r+=e);var g="";if(null!=t[a]&&"undefined"!=typeof t[a].constructor&&(g="undefined"!=typeof t[a].constructor.name?t[a].constructor.name:0==t[a].constructor.toString().indexOf("function")?"function":t[a].constructor.toString()),n&&"object"==typeof t[a]&&null!=t[a]&&"undefined"!=typeof t[a].constructor&&t[a].constructor!=Image&&t[a].constructor!=Date&&-1==g.indexOf("HTML"))if(i){var h=this.evalToolCnt++,u=this.objectToString(t[a],e,i,o,n);r+=""!=u?"<tr><th><a href=javascript:; onclick='lpMTagDebug.toggleViewMode("+h+")'>"+a+"</a></th><td id='emtDebugLibObjectInfo-"+h+"' class='emtDebugLibHiddenTD'>"+u+"</td>":"<tr><th>"+a+"</th><td id='emtDebugLibObjectInfo-"+h+"'>"+u+"</td>"}else r+="'"+a+"':'"+this.objectToString(t[a],e,i,o,n)+"'";else{var d=null==t[a]?"":t[a].toString();d=d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),r+=i?"<tr><th>"+a+"</th><td>"+d+"</td>":"'"+a+"':'"+d+"'"}}return""!=r&&(r=s+r,r+=i?"</table>":"}"),r},this.logPlayer=function(t){var e,i=this;switch(t){case this._LOG_TRASH:this.log=[],this.clearLogDisplay();break;case this._LOG_PLAY:e=this.GetObj("emtDebugLibLogPlay"),e.onclick=function(){i.logPlayer(i._LOG_PAUSE)},e=this.GetObj("emtDebugLibLogPlayImg"),e.src=this.baseURL+"images/pause.png",e=this.GetObj("emtDebugLibMsgStatusLogPlayerStatus"),e.innerHTML="Log Active",this.logStatus=t,this.clearLogDisplay(),this.displayFullLog(this.log);break;case this._LOG_PAUSE:e=this.GetObj("emtDebugLibLogPlay"),e.onclick=function(){i.logPlayer(i._LOG_PLAY)},e=this.GetObj("emtDebugLibLogPlayImg"),e.src=this.baseURL+"images/play.png",e=this.GetObj("emtDebugLibMsgStatusLogPlayerStatus"),e.innerHTML="Log Paused",this.logStatus=t;break;case this._LOG_STOP:e=this.GetObj("emtDebugLibLogPlay"),e.onclick=function(){i.logPlayer(i._LOG_PLAY)},e=this.GetObj("emtDebugLibLogPlayImg"),e.src=this.baseURL+"images/play.png",e=this.GetObj("emtDebugLibMsgStatusLogPlayerStatus"),e.innerHTML="Log Stopped",this.logStatus=t}return!1},this.toggleLog=function(){this.toolsShown&&this.toggleTools();var t=this;if(this.logShown)this.logShown=!1,this.hideMsgWindow();else{this.logShown=!0;var e="<a id='emtDebugLibLogToggleTime' href=javascript:;><img src='"+this.baseURL+"images/time.png' border='0'/></a>&nbsp;&nbsp;<a id='emtDebugLibLogToggleFilter' href=javascript:;><img src='"+this.baseURL+"images/filter.png'  border='0'/></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMT Log";this.showMsgWindow(!0,e);var i=this.GetObj("emtDebugLibLogToggleTime");i.onclick=function(){return t.toggleLogTime(),!1};var i=this.GetObj("emtDebugLibLogToggleFilter");i.onclick=function(){return t.toggleLogFilter(),!1},this.displayFullLog(this.log)}return this.resizeShowHideImage(),!1},this.toggleLogFilter=function(){if(this.showLogFilter=!this.showLogFilter,this.showLogFilter){var t="<table><tr>",e=[];e[0]="",e[1]="";var i=0;for(var o in this.msgSources)if("object"==typeof this.msgSources[o]&&this.msgSources[o].source){for(var n="",s=0;s<this.activeFilter.length;s++)if(o==this.activeFilter[s]){n="checked";break}e[i]+='<input name="emtDebugLibFilterChoice" value="'+o+'" type="checkbox" '+n+">"+o+"</input><br>",i=0==i?1:0}t+="<td>"+e[0]+"</td>",t+="<td>"+e[1]+"</td>",t+="<td align='center'>&nbsp;&nbsp;<a id='emtDebugLibLogToggleFilterApply' href=javascript:;><img src='"+this.baseURL+"images/apply.png' border='0'/></td></a>",t+="<td align='center'>&nbsp;&nbsp;<a id='emtDebugLibLogToggleFilterCancel' href=javascript:;><img src='"+this.baseURL+"images/cancel.png' border='0'/></td></a>",t+="</tr></table>";var r=this.GetObj("emtDebugLibFilterWindow");if(null!=r){r.innerHTML=t;var l=this,a=this.GetObj("emtDebugLibLogToggleFilterApply");a.onclick=function(){return l.logFilterApply(),!1},a=this.GetObj("emtDebugLibLogToggleFilterCancel"),a.onclick=function(){return l.logFilterCancel(),!1}}this.showObj("emtDebugLibFilterRow")}else this.hideObj("emtDebugLibFilterRow")},this.logFilterCancel=function(){this.showLogFilter=!this.showLogFilter,this.activeFilter=[],this.hideObj("emtDebugLibFilterRow"),this.displayFullLog(this.log)},this.logFilterApply=function(){this.showLogFilter=!this.showLogFilter,this.activeFilter=[],this.hideObj("emtDebugLibFilterRow");for(var t=document.getElementsByName("emtDebugLibFilterChoice"),e=0;e<t.length;e++)t[e].checked&&(this.activeFilter[this.activeFilter.length]=t[e].value);this.displayFullLog(this.log)},this.toggleLogTime=function(){return this.showTimeinLog=!this.showTimeinLog,this.displayFullLog(this.log),!1},this.hideMsgWindow=function(){this.msgShown=!1,this.logShown&&(this.logShown=!1),this.hideObj("emtDebugLibMainLogWindow",!0),this.GetObj("emtDebugLibLogWindow").innerHTML="",this.resizeShowHideImage()},this.showMsgWindow=function(t,e,i,o){this.msgShown=!0,this.resizeShowHideImage(),this.showTR("emtDebugLibMainLogWindow"),this.showObj("emtDebugLibMainLogWindow",!1);var n;if("undefined"!=typeof t&&t){this.GetObj("emtDebugLibMessageWindowCtrlPanel").innerHTML=this.logCtrlPanelHTML;var s=this;n=this.GetObj("emtDebugLibLogPlay"),n.onclick=function(){s.logPlayer(s._LOG_PAUSE)},n=this.GetObj("emtDebugLibLogStop"),n.onclick=function(){s.logPlayer(s._LOG_STOP)},n=this.GetObj("emtDebugLibLogErase"),n.onclick=function(){s.logPlayer(s._LOG_TRASH)}}else this.GetObj("emtDebugLibMessageWindowCtrlPanel").innerHTML="";e&&(this.GetObj("emtDebugLibMessageWindowTitle").innerHTML=e),i&&(this.GetObj("emtDebugLibLogWindow").innerHTML=i),"undefined"==typeof o||this.resized||(n=this.GetObj("emtDebugLibLogWindow"),o.width&&(n.style.width=o.width+"px"),o.height&&(n.style.height=o.height+"px"),n.style.overflow="auto")},this.toggleTools=function(){if(this.toolsShown)this.toolsShown=!1,this.hideObj("emtDebugLibToolsDiv");else{this.toolsShown=!0;var t;"undefined"!=typeof lpMTag&&(t=this.GetObj("emtDebugLibStopStartEMT"),lpMTag.stopMTag?t.innerHTML="Start EMT":t.innerHTML="Stop EMT"),t=this.GetObj("emtDebugLibSwitchSnipMode"),this.GetCookie(this.debugCookieName)==this.debugCookieValue?t.innerHTML="Compact Snip":t.innerHTML="Clear Snip","undefined"!=typeof lpMTagConfig&&"undefined"!=typeof lpMTagConfig.lpServer&&document.location.host==lpMTagConfig.lpServer||this.hideObj("emtDebugLibSwitchSnipMode"),"undefined"==typeof lpMTagConfig||"undefined"==typeof lpMTagConfig.lpServer||"undefined"==typeof lpMTagConfig.lpNumber?this.hideObj("emtDebugLibAdminArea"):this.showObj("emtDebugLibAdminArea");var e=this.getElWidthHeight("emtDebugLibToggleTools","emtDebugLibmainDiv");t=this.GetObj("emtDebugLibToolsDiv"),t.style.left=e.ul.x+"px",t.style.top=e.br.y+3+"px",this.showObj("emtDebugLibToolsDiv")}return!1},this.updateConfig=function(){var t=this,e=!1,i=this.GetObj("emtDebugLibStatusProgress");this.progressIdx++,this.progressIdx==this.progressSymbols.length&&(this.progressIdx=0),i.innerHTML=this.progressSymbols[this.progressIdx];var o=new Date,n=new Date,s=o.getTime()-this.timestart.getTime();n.setTime(s);var r=n.getUTCMinutes()>0?n.getUTCMinutes()+"m ":"",l=n.getUTCHours()>0?n.getHours()+"h ":"",a=n.getUTCSeconds()+"s",g=l+r+a;if(i=this.GetObj("emtDebugLibStatusTimeOnPage"),i.innerHTML=g,"undefined"!=typeof lpTag){var h=lpTag.site||"Not Found";i=this.GetObj("emtDebugLibEMTsiteSrv"),e=!0,i.innerHTML=h;var u=this.noValueStr;"undefined"!=typeof lpMTag&&(u=lpMTag.ver+" b"+lpMTag.build),i=this.GetObj("emtDebugLibEMTver"),i.innerHTML!=u&&(e=!0,i.innerHTML=u),this.leChatRef="undefined"!=typeof lpTagConfig&&"undefined"!=typeof lpTagConfig.tagPlugins?lpTagConfig.tagPlugins:null,this.leChatProps.ver="undefined"!=typeof lpTagConfig?" ("+lpTagConfig._ver+")":"","undefined"!=typeof lpTagConfig&&(this.leChatProps.ver=" (VS: "+lpTagConfig._ver+")"),"undefined"!=typeof LEChat&&"undefined"!=typeof LEChat.conf&&"undefined"!=typeof LEChat.conf.ver&&(this.leChatProps.ver+=" (LE: "+LEChat.conf.ver+")");var d="undefined"!=typeof lpTag?lpTag._v:this.noValueStr;i=this.GetObj("emtDebugLibLPTAGver"),i.innerHTML!=d&&(e=!0,i.innerHTML=d);var b="undefined"!=typeof lpTag?lpTag._tagv:this.noValueStr;i=this.GetObj("emtDebugLibTAGver"),i.innerHTML!=b&&(e=!0,i.innerHTML=b);var m=this.noValueStr;"undefined"!=typeof lpMTagConfig.serverVer&&(m=lpMTagConfig.serverVer,"undefined"!=typeof lpMTagConfig.serverBuild&&(m=m+" b"+lpMTagConfig.serverBuild)),i=this.GetObj("emtDebugLibSRVver"),i.innerHTML!=m&&(e=!0,i.innerHTML=m);var c=this.noValueStr;"undefined"!=typeof lpMTagConfig.dynButton&&lpMTagConfig.dynButton.length>0&&(c=lpMTagConfig.dynButton.length),i=this.GetObj("emtDebugLibDBcnt"),i.innerHTML!=c&&(e=!0,i.innerHTML=c,i.onclick=function(){t.dynButtonInfo()},i.className="emtDebugInfo");var f=this.noValueStr;if("undefined"!=typeof lpMTagStatic)for(var p in lpMTagStatic)-1!=p.indexOf("lpStaticBut")&&(f==this.noValueStr&&(f=0),f++);i=this.GetObj("emtDebugLibSBcnt"),i.innerHTML!=f&&(e=!0,i.innerHTML=f,i.onclick=function(){t.statButtonInfo()},i.className="emtDebugInfo");var L=this.noValueStr,v=0;for(var p in lpMTagConfig)-1!=p.indexOf("inviteMC")?parseInt(p.replace(/inviteMC/,""),10)>0&&v++:-1!=p.indexOf("invite")&&parseInt(p.replace(/invite/,""),10)>0&&v++;v>0&&(L=v),i=this.GetObj("emtDebugLibINVcnt"),i.innerHTML!=L&&(e=!0,i.innerHTML=L,i.onclick=function(){t.invitationInfo()},i.className="emtDebugInfo"),this.counters.logOK>0&&(i=this.GetObj("emtDebugLibOKcnt"),i.innerHTML!=this.counters.logOK&&(e=!0,i.innerHTML=this.counters.logOK),i.className="emtDebugOK"),this.counters.logWarn>0&&(i=this.GetObj("emtDebugLibWARNcnt"),i.innerHTML!=this.counters.logWarn&&(e=!0,i.innerHTML=this.counters.logWarn),i.className="emtDebugWarn",i.onclick=function(){t.logShowErrWarn("warn")},0==this.counters.logErr&&(i=this.GetObj("emtDebugLibStatusImage"),i.src=this.baseURL+"images/status_warn.png",i.style.cursor="pointer",i.onclick=function(){t.maximizeAll(),t.logShowErrWarn("warn")})),this.counters.logErr>0&&(i=this.GetObj("emtDebugLibERRcnt"),i.innerHTML!=this.counters.logErr&&(e=!0,i.innerHTML=this.counters.logErr),i.className="emtDebugError",i.onclick=function(){t.logShowErrWarn("error")},i=this.GetObj("emtDebugLibStatusImage"),i.src=this.baseURL+"images/status_error.png",i.style.cursor="pointer",i.onclick=function(){t.maximizeAll(),t.logShowErrWarn("error")}),this.counters.connGET>0&&(i=this.GetObj("emtDebugLibGETcnt"),i.innerHTML!=this.counters.connGET&&(e=!0,i.innerHTML=this.counters.connGET)),this.counters.connPOST>0&&(i=this.GetObj("emtDebugLibPOSTcnt"),i.innerHTML!=this.counters.connPOST&&(e=!0,i.innerHTML=this.counters.connPOST)),i=this.GetObj("leChatVer"),i.innerHTML!=this.leChatProps.ver&&(e=!0,i.innerHTML=this.leChatProps.ver),i=this.GetObj("emtDebugLibEMcntLPChat"),0!==this.leChatProps.numberOfButtons&&0!==this.leChatProps.numberOfButtonsInPage||(this.leChatProps.numberOfButtons=this.leChatProps.getNumberOfElements(this.leChatProps.engagementType.button,!1),this.leChatProps.numberOfButtonsInPage=this.leChatProps.getNumberOfElements(this.leChatProps.engagementType.button,!0)),i.innerHTML!=this.leChatProps.numberOfButtons&&(e=!0,i.className="emtDebugInfo",i.innerHTML='<span id="embeddedButtons">'+this.leChatProps.numberOfButtons+'</span><span id="embededLoadedButtons">('+this.leChatProps.numberOfButtonsInPage+")</span>",i=this.GetObj("embeddedButtons"),i.onclick=function(){t.engagementLeChatInfo(t.leChatProps.engagementType.button,!1)},i=this.GetObj("embededLoadedButtons"),i.onclick=function(){t.engagementLeChatInfo(t.leChatProps.engagementType.button,!0)}),i=this.GetObj("emtDebugLibSBcntLPChat"),0!==this.leChatProps.numberOfStickyButtons&&0!==this.leChatProps.numberOfStickyButtonsInPage||(this.leChatProps.numberOfStickyButtons=this.leChatProps.getNumberOfElements(t.leChatProps.engagementType.sticky_button,!1),this.leChatProps.numberOfStickyButtonsInPage=this.leChatProps.getNumberOfElements(t.leChatProps.engagementType.sticky_button,!0)),i.innerHTML!=this.leChatProps.numberOfStickyButtons&&(e=!0,i.className="emtDebugInfo",i.innerHTML='<span id="stickyButtons">'+this.leChatProps.numberOfStickyButtons+'</span><span id="stickyButtonsLoaded">('+this.leChatProps.numberOfStickyButtonsInPage+")</span>",i=this.GetObj("stickyButtons"),i.onclick=function(){t.engagementLeChatInfo(t.leChatProps.engagementType.sticky_button,!1)},i=this.GetObj("stickyButtonsLoaded"),i.onclick=function(){t.engagementLeChatInfo(t.leChatProps.engagementType.sticky_button,!0)}),i=this.GetObj("emtDebugLibINVcntLPChat"),0!==this.leChatProps.numberOfInvitations&&0!==this.leChatProps.numberOfInvitationsInPage||(this.leChatProps.numberOfInvitations=this.leChatProps.getNumberOfElements(this.leChatProps.engagementType.invitation,!1),this.leChatProps.numberOfInvitationsInPage=this.leChatProps.getNumberOfElements(this.leChatProps.engagementType.invitation,!0)),i.innerHTML!=this.leChatProps.numberOfInvitations&&(e=!0,i.className="emtDebugInfo",i.innerHTML='<span id="invitations">'+this.leChatProps.numberOfInvitations+'</span><span id="invitationsLoaded">('+this.leChatProps.numberOfInvitationsInPage+")</span>",i=this.GetObj("invitations"),i.onclick=function(){t.engagementLeChatInfo(t.leChatProps.engagementType.invitation,!1)},i=this.GetObj("invitationsLoaded"),i.onclick=function(){t.engagementLeChatInfo(t.leChatProps.engagementType.invitation,!0)})}this.timerRef=setTimeout(function(){t.updateConfig()},1e3*this.timerPeriod)},this.minimizeAll=function(){var t=this;this.toolsShown&&this.toggleTools(),this.logShown&&this.toggleLog(),this.hideObj("emtDebugLibMonitorWindow"),this.hideObj("emtDebugLibMainLogWindow");var e=this.GetObj("emtDebugLibImgMinimize");return e.src=this.baseURL+"images/maximize_box.png",e.onclick=function(){t.maximizeAll()},!1},this.showTR=function(t){"IE"==this.browser?this.GetObj(t).style.display="block":this.GetObj(t).style.display="table-row",this.showObj(t,!1)},this.maximizeAll=function(){var t=this;this.showTR("emtDebugLibMonitorWindow");var e=this.GetObj("emtDebugLibImgMinimize");return e.src=this.baseURL+"images/minimize_box.png",e.onclick=function(){t.minimizeAll()},!1},this.minimizeMsgDiv=function(){return this.hideMsgWindow(),!1},this.resizeShowHideImage=function(){var t=this.GetObj("emtDebugLibStatusResize");if(this.msgShown){var e=this;t.className="emtDebugLibStatusResize",t.onmousedown=function(t){e.resizeStart("emtDebugLibLogWindow",t)}}else t.className="emtDebugLibStatusNOResize",t.onmousedown=null},this.resizeObj=null,this.resized=!1,this.resizeStart=function(t,e){if(!this.msgShown)return!1;if(this.resizeObj=this.GetObj(t),null==this.resizeObj)return void alert("NO resize Object:"+t);this.resized=!0;var i,o;return"IE"==this.browser?(i=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft,o=window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop):(i=e.clientX+window.scrollX,o=e.clientY+window.scrollY),this.resizeCursorStartX=i,this.resizeCursorStartY=o,this.resizeElStartDimen=this.getElWidthHeight(t),"IE"==this.browser?(document.attachEvent("onmousemove",lpMTagDebug.resizeGo),document.attachEvent("onmouseup",lpMTagDebug.resizeStop),window.event.cancelBubble=!0,window.event.returnValue=!1):(document.addEventListener("mousemove",lpMTagDebug.resizeGo,!0),document.addEventListener("mouseup",lpMTagDebug.resizeStop,!0),e.preventDefault()),!1},this.resizeGo=function(t){var e,i;"IE"==lpMTagDebug.browser?(e=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft,i=window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop):(e=t.clientX+window.scrollX,i=t.clientY+window.scrollY);var o=lpMTagDebug.resizeElStartDimen.width+(e-lpMTagDebug.resizeCursorStartX),n=lpMTagDebug.resizeElStartDimen.height+(i-lpMTagDebug.resizeCursorStartY);o>=0&&(lpMTagDebug.resizeObj.style.width=o+"px"),n>=0&&(lpMTagDebug.resizeObj.style.height=n+"px");var s=lpMTagDebug.getElWidthHeight("emtDebugLibMainLogWindow");return o<s.width&&o>=0&&(lpMTagDebug.resizeObj.style.width=s.width+"px"),!1},this.resizeStop=function(){return"IE"==lpMTagDebug.browser?(document.detachEvent("onmousemove",lpMTagDebug.resizeGo),document.detachEvent("onmouseup",lpMTagDebug.resizeStop)):(document.removeEventListener("mousemove",lpMTagDebug.resizeGo,!0),document.removeEventListener("mouseup",lpMTagDebug.resizeStop,!0)),!1},this.getElWidthHeight=function(t,e){var i=this.GetObj(t);if(null==i)return alert("Error getting the element:"+t),!1;var o={};o.x=i.offsetLeft,o.y=i.offsetTop;for(var n=i.offsetParent;n&&n.id!=e&&"BODY"!=n.tagName.toUpperCase();)o.x+=n.offsetLeft,o.y+=n.offsetTop,n=n.offsetParent;var s={};return s.x=o.x+i.offsetWidth,s.y=o.y+i.offsetHeight,{width:s.x-o.x,height:s.y-o.y,ul:o,br:s}},this.dragObj=null,this.DragStart=function(t,e){if(this.toolsShown&&(this.hideObj("emtDebugLibToolsDiv"),this.toolsShown=!1),this.dragObj=this.GetObj(t),null==this.dragObj)return void alert("NO drag Object");var i,o;return"IE"==this.browser?(i=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft,o=window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop):(i=e.clientX+window.scrollX,o=e.clientY+window.scrollY),this.dragCursorStartX=i,this.dragCursorStartY=o,this.dragElStartLeft=parseInt(this.dragObj.style.left,10),this.dragElStartTop=parseInt(this.dragObj.style.top,10),isNaN(this.dragElStartLeft)&&(this.dragElStartLeft=0),isNaN(this.dragElStartTop)&&(this.dragElStartTop=0),"IE"==this.browser?(document.attachEvent("onmousemove",lpMTagDebug.dragGo),document.attachEvent("onmouseup",lpMTagDebug.dragStop),window.event.cancelBubble=!0,window.event.returnValue=!1):(document.addEventListener("mousemove",lpMTagDebug.dragGo,!0),document.addEventListener("mouseup",lpMTagDebug.dragStop,!0),e.preventDefault()),!1},this.dragGo=function(t){var e,i;"IE"==lpMTagDebug.browser?(e=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft,i=window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop):(e=t.clientX+window.scrollX,i=t.clientY+window.scrollY);var o=lpMTagDebug.dragElStartLeft+e-lpMTagDebug.dragCursorStartX;1>o&&(o=1);var n=lpMTagDebug.dragElStartTop+i-lpMTagDebug.dragCursorStartY;return 1>n&&(n=1),lpMTagDebug.dragObj.style.left=o+"px",lpMTagDebug.dragObj.style.top=n+"px","IE"==lpMTagDebug.browser?(window.event.cancelBubble=!0,window.event.returnValue=!1):t.preventDefault(),!1},this.dragStop=function(){return"IE"==lpMTagDebug.browser?(document.detachEvent("onmousemove",lpMTagDebug.dragGo),document.detachEvent("onmouseup",lpMTagDebug.dragStop)):(document.removeEventListener("mousemove",lpMTagDebug.dragGo,!0),document.removeEventListener("mouseup",lpMTagDebug.dragStop,!0)),!1},this.hideObj=function(t,e){"undefined"==typeof e&&(e=!0);var i=this.GetObj(t);null!=i&&(i.style.visibility="hidden",e&&(i.style.display="none"))},this.showObj=function(t,e){"undefined"==typeof e&&(e=!0);var i=this.GetObj(t);null!=i&&(i.style.visibility="visible",e&&(i.style.display="block"))},this.Display=function(t,e,i){if(t.indexOf("Garbage Collection")>-1){if(this.garbColStrCnt++,10==this.garbColStrCnt)t="PAUSING LOG DISPLAY",e="WARN";else if(this.garbColStrCnt>10)return}else this.garbColStrCnt=0;t.indexOf("GET")>-1&&this.counters.connGET++,t.indexOf("POST")>-1&&this.counters.connPOST++;var o,n,s;if(t.indexOf("EVENT")>-1)if(t.indexOf("DynBut")>-1){var r=null;if(o=null,n=t.indexOf("lpMTagConfig.dynButton"),-1!=n&&(o=n+"lpMTagConfig.dynButton".length,r=parseInt(t.substr(o),10)),null==r){n=t.indexOf("DynBut")+"DynBut ".length;for(var l=t.substring(n,t.indexOf("EVENT")-1),a=0;a<lpMTagConfig.dynButton.length;a++)if(lpMTagConfig.dynButton[a].name==l){r=a;break}}s=t.substr(t.indexOf("EVENT")+" EVENT:".length),"undefined"==typeof this.eventLog.dynButton["but"+r]&&(this.eventLog.dynButton["but"+r]=[]),this.eventLog.dynButton["but"+r][this.eventLog.dynButton["but"+r].length]=s}else if(t.indexOf("lpMTagConfig.invite")>-1){n=t.indexOf("lpMTagConfig.invite"),o=n+"lpMTagConfig.invite".length;var g=parseInt(t.substr(o),10);isNaN(g)&&(o=n+"lpMTagConfig.inviteMC".length,g=parseInt(t.substr(o),10)),s=t.substr(o+g.toString().length+" EVENT: ".length),"undefined"==typeof this.eventLog.invite["inv"+g]&&(this.eventLog.invite["inv"+g]=[]),this.eventLog.invite["inv"+g][this.eventLog.invite["inv"+g].length]=s}"ERROR"==e?this.counters.logErr++:"EXEC-OK"==e?this.counters.logOK++:"WARN"==e?this.counters.logWarn++:this.counters.logOK++,this.counters.logLine++,this.log.length==this.logMaxLines&&this.log.shift();var h=new Date,u=h.getHours(),d=h.getMinutes(),b=h.getSeconds();10>u&&(u="0"+u),10>d&&(d="0"+d),10>b&&(b="0"+b);var m=u+":"+d+":"+b;"undefined"==typeof i&&(i="Not specified");var c={msg:t,time:m,level:e,source:i};"undefined"==typeof this.msgSources[i]&&(this.msgSources[i]={source:i}),"ERROR"==e?this.logErr[this.logErr.length]=c:"WARN"==e&&(this.logWarn[this.logWarn.length]=c),this.logStatus!=this._LOG_STOP&&(this.log[this.log.length]=c,this.logShown&&this.logStatus!=this._LOG_PAUSE&&this.printLogLine(c))},this.displayFullLog=function(t){this.clearLogDisplay();for(var e=0;e<t.length;e++)this.printLogLine(t[e])},this.clearLogDisplay=function(){var t=this.GetObj("emtDebugLibLogWindow");t.innerHTML=""},this.logShowErrWarn=function(t){this.logShown&&this.toggleLog(),this.toolsShown&&this.toggleTools();var e;if("warn"==t)e=this.logWarn;else{if("error"!=t)return void alert("wrong logType="+t);e=this.logErr}return this.showMsgWindow(!1,"Error Messages from Log &nbsp;&nbsp;&nbsp;!!!Not updated Live!!!","",{width:400,height:this.maxLogWindowMaxHeight}),this.displayFullLog(e),!1},this.printLogLine=function(t){var e=!0;if(this.activeFilter.length>0){e=!1;for(var i=0;i<this.activeFilter.length;i++)if(t.source==this.activeFilter[i]){e=!0;break}if(!e)return}var o="";o="ERROR"==t.level?"emtDebugLibLogMessageERROR":"EXEC-OK"==t.level?"emtDebugLibLogMessageOK":"WARN"==t.level?"emtDebugLibLogMessageWARN":"emtDebugLibLogMessageDEBUG";var n=this.GetObj("emtDebugLibLogWindow"),s=document.createElement("div");s.id="mtagTextDiv-"+this.counters.logLine,s.className=o,s.innerHTML=(this.showTimeinLog?t.time+"&nbsp;&nbsp;":"")+t.msg,null!=n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s);var r,l=this.getElWidthHeight("emtDebugLibLogWindow");!this.resized&&l.height>this.maxLogWindowMaxHeight&&(r=this.GetObj("emtDebugLibLogWindow"),r.style.height=this.maxLogWindowMaxHeight+"px",this.logWindowDimensionLimited||(r.style.width=l.width+15+"px"),r.style.overflow="auto",this.logWindowDimensionLimited=!0),!this.resized&&l.width>this.maxLogWindowMaxWidth&&(r=this.GetObj("emtDebugLibLogWindow"),r.style.width=this.maxLogWindowMaxWidth+"px",r.style.overflow="auto",this.logWindowDimensionLimited=!0)},this.getUdes=function(){"undefined"!=typeof lpMTagConfig&&(this.ude.page=lpMTagConfig.pageVar,this.ude.session=lpMTagConfig.sessionVar,this.ude.visitor=lpMTagConfig.visitorVar)},this.showUdes=function(){this.logShown&&this.toggleLog(),this.toolsShown&&this.toggleTools();var t="<b>Page UDEs</b><br />";return t+=this.objectToString(this.ude.page,void 0,!0,"emtDebugLibGeneralInfo",!1),t+="<br /><b>Session UDEs</b>",t+=this.objectToString(this.ude.session,void 0,!0,"emtDebugLibGeneralInfo",!1),t+="<br /><b>Visitor UDEs</b>",t+=this.objectToString(this.ude.visitor,void 0,!0,"emtDebugLibGeneralInfo",!1),this.showMsgWindow(!1,"UDEs at page start",t,{width:400,height:this.maxLogWindowMaxHeight}),!1},this.DisplayArray=function(t,e){for(var i=0;i<t.length;i++){var o=t[i].split("<!!>");this.Display(o[0],o[1],e)}},this.GetPageWidth=function(){return document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:document.body?document.body.clientWidth:window.innerWidth},this.SetCookie=function(t,e,i,o,n,s){var r=new Date,l=r.getTime();"undefined"!=typeof i&&null!=i||(i=1e3*i*60*60*24,l=r.getTime()+i),document.cookie=t+"="+escape(e)+(i?";expires="+l.toGMTString():"")+(o?";path="+o:"")+(n?";domain="+n:"")+(s?";secure":"")},this.DeleteCookie=function(t,e,i){this.GetCookie(t)&&(document.cookie=t+"="+(e?";path="+e:"")+(i?";domain="+i:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT")},this.GetCookie=function(t){var e=document.cookie.indexOf(t+"="),i=e+t.length+1;if(!e&&t!=document.cookie.substring(0,t.length))return null;if(-1==e)return null;var o=document.cookie.indexOf(";",i);return-1==o&&(o=document.cookie.length),unescape(document.cookie.substring(i,o))},this.start=function(){var t=this;"undefined"!=typeof lpMTagConfig&&"undefined"!=typeof lpMTagConfig.emtDebugZindex||(this.zindex=this.getMaxZindex()+1),this.getUdes(),this.browser=this.BrowserSniff(),this.addCss(),this.generateHTML(),this.createGenericDiv("emtDebugLibmainDiv",this.zindex,this.posX,this.posY,null,null,this.emtHtml,null,null,0),"undefined"!=typeof lpMTagConfig&&"undefined"!=typeof lpMTagConfig.emtDebugPosRight&&lpMTagConfig.emtDebugPosRight&&(this.posX=this.GetPageWidth()-this.GetObj("emtDebugLibmainDiv").clientWidth-30),this.GetObj("emtDebugLibmainDiv").style.left=this.posX+"px",this.showObj("emtDebugLibmainDiv",!1),this.attachEvents(),"undefined"!=typeof lpMTagConfig&&"undefined"!=typeof lpMTagConfig.emtDebugSuperMiniMode&&lpMTagConfig.emtDebugSuperMiniMode&&this.minimizeAll(),this.timerRef=setTimeout(function(){t.updateConfig()},500)}}var lpMTagDebug=new emtDebugLib;lpMTagDebug.start();